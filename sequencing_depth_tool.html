<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Metagenomic Coverage Calculator</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 40px;
    max-width: 800px;
  }
  h1 { margin-bottom: 5px; }
  h2 { margin-top: 40px; }
  label { display: block; margin-top: 10px; }
  input { width: 120px; padding: 5px; margin-left: 10px; }
  button { margin-top: 15px; padding: 8px 14px; }
  table {
    border-collapse: collapse;
    margin-top: 20px;
    width: 100%;
  }
  th, td {
    border: 1px solid #aaa;
    padding: 6px;
    text-align: center;
  }
  th { background: #eee; }
</style>
</head>

<body>

<h1>Metagenomic Coverage Calculator</h1>
<p>Estimate genome coverage from sequencing depth and relative abundance, or compute required depth for a target coverage.</p>

<h2>Coverage From Sequencing Depth</h2>

<label>
  Relative abundance (%):
  <input id="abundance" type="number" value="1" step="0.01">
</label>

<label>
  Genome size (Mb):
  <input id="genome" type="number" value="4" step="0.1">
</label>

<label>
  Sequencing depth (Gb):
  <input id="depth" type="number" value="10" step="0.1">
</label>

<button onclick="computeCoverage()">Compute Coverage</button>

<p id="coverageResult" style="font-weight:bold;"></p>


<h2>Required Sequencing Depth for Target Coverage</h2>

<label>
  Target coverage (×):
  <input id="targetCoverage" type="number" value="10" step="0.1">
</label>

<label>
  Relative abundance (%):
  <input id="abundance2" type="number" value="1" step="0.01">
</label>

<label>
  Genome size (Mb):
  <input id="genome2" type="number" value="4" step="0.1">
</label>

<button onclick="computeRequiredDepth()">Compute Required Depth</button>

<p id="depthResult" style="font-weight:bold;"></p>


<h2>Cheat Sheet: Coverage Across Depths and Relative Abundances</h2>
<p>Automatically updates when genome size changes.</p>

<label>
  Genome size (Mb):
  <input id="genomeCheat" type="number" value="4" step="0.1" oninput="updateCheatSheet()">
</label>

<table id="cheatTable">
  <thead>
    <tr>
      <th>Depth (Gb)</th>
      <th>RA 10%</th>
      <th>RA 1%</th>
      <th>RA 0.1%</th>
      <th>RA 0.01%</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>


<script>
// Coverage calculator
function computeCoverage() {
  const A = parseFloat(document.getElementById('abundance').value) / 100.0;
  const G = parseFloat(document.getElementById('genome').value);
  const D = parseFloat(document.getElementById('depth').value);

  const coverage = (D * 1000 * A) / G;
  document.getElementById('coverageResult').innerText =
    `Estimated coverage: ${coverage.toFixed(2)}×`;
}

// Required depth calculator
function computeRequiredDepth() {
  const C = parseFloat(document.getElementById('targetCoverage').value);
  const A = parseFloat(document.getElementById('abundance2').value) / 100.0;
  const G = parseFloat(document.getElementById('genome2').value);

  const depthGb = (C * G) / (1000 * A);
  document.getElementById('depthResult').innerText =
    `Required sequencing depth: ${depthGb.toFixed(2)} Gb`;
}

// Cheat sheet generator
function updateCheatSheet() {
  const G = parseFloat(document.getElementById('genomeCheat').value);
  const depths = [1, 5, 10, 20];
  const abundances = [0.10, 0.01, 0.001, 0.0001];

  const tbody = document.querySelector('#cheatTable tbody');
  tbody.innerHTML = "";

  depths.forEach(D => {
    const row = document.createElement('tr');
    const depthCell = document.createElement('td');
    depthCell.textContent = D;
    row.appendChild(depthCell);

    abundances.forEach(A => {
      const cov = (D * 1000 * A) / G;
      const cell = document.createElement('td');
      cell.textContent = cov.toFixed(2) + "×";
      row.appendChild(cell);
    });

    tbody.appendChild(row);
  });
}

// Initialize cheat sheet on load
updateCheatSheet();
</script>

<div style="margin-top:40px; padding:20px; border:2px solid #888; background:#f0f8ff;">
  <h2>Minimum Relative Abundance Required</h2>
  <p>
    When the relative abundance of a species is unknown, you can estimate the minimum abundance
    required to achieve a desired coverage given a specific sequencing depth and genome size.
    This is useful for planning sequencing depth when targeting low-abundance organisms.
  </p>

  <label>
    Target coverage (×):
    <input id="targetCoverageRA" type="number" value="5" step="0.1">
  </label>

  <label>
    Genome size (Mb):
    <input id="genomeRA" type="number" value="4" step="0.1">
  </label>

  <label>
    Sequencing depth (Gb):
    <input id="depthRA" type="number" value="10" step="0.1">
  </label>

  <button onclick="computeRequiredRA()">Compute Minimum RA</button>

  <p id="raResult" style="font-weight:bold;"></p>

  <script>
    function computeRequiredRA() {
      const C = parseFloat(document.getElementById('targetCoverageRA').value);
      const G = parseFloat(document.getElementById('genomeRA').value);
      const D = parseFloat(document.getElementById('depthRA').value);

      const A = (C * G) / (1000 * D);   // fraction
      const A_percent = A * 100;

      document.getElementById('raResult').innerText =
        `Minimum relative abundance required: ${A_percent.toFixed(4)}%`;
    }
  </script>

  <h3>Scientific Basis</h3>
  <p>
    This calculation is derived by rearranging the standard sequencing coverage equation:
  </p>

  <pre style="background:#eee; padding:10px;">
Coverage = (D × 1000 × A) / G
A = (Coverage × G) / (1000 × D)
  </pre>

  <p>
    This inverse form is widely used in metagenomic study design to determine the minimum
    abundance at which a genome can be assembled or profiled at a given sequencing depth.
  </p>
</div>

<!-- ============================
     EXPLANATION & REFERENCES BOX
     ============================ -->
<div style="margin-top:40px; padding:20px; border:2px solid #888; background:#f7f7f7;">
  <h2>How These Calculations Work</h2>

  <p><strong>1. Bases sequenced for the species</strong><br>
     Total sequencing depth is measured in gigabases (Gb), where 1 Gb = 10<sup>9</sup> bases.
     If a species has relative abundance A (e.g., 1% = 0.01), then the number of bases
     sequenced for that species is:
  </p>

  <pre style="background:#eee; padding:10px;">
Species bases = D × 10⁹ × A
  </pre>

  <p><strong>2. Genome size conversion</strong><br>
     Genome size G is entered in megabases (Mb), where 1 Mb = 10<sup>6</sup> bases.
  </p>

  <pre style="background:#eee; padding:10px;">
Genome bases = G × 10⁶
  </pre>

  <p><strong>3. Coverage formula</strong><br>
     Coverage is defined as the number of sequenced bases divided by the genome size:
  </p>

  <pre style="background:#eee; padding:10px;">
Coverage = (D × 10⁹ × A) / (G × 10⁶)
         = (D × 1000 × A) / G
  </pre>

  <p>This is the standard definition of sequencing coverage used in genomics and metagenomics.</p>

  <p><strong>4. Required sequencing depth for a target coverage</strong><br>
     Rearranging the coverage formula gives:
  </p>

  <pre style="background:#eee; padding:10px;">
Required depth (Gb) = (Coverage × G) / (1000 × A)
  </pre>

  <p>This is commonly used in metagenomic sampling‑depth calculations for MAG recovery.</p>


  <!-- ============================
       GROUPED REFERENCES
       ============================ -->
  <h2>References</h2>

  <!-- COVERAGE THEORY -->
  <h3>Coverage Theory & Sequencing Mathematics</h3>
  <ul>
    <li>
      Lander, E. S., & Waterman, M. S. (1988). Genomic mapping by fingerprinting random clones:
      A mathematical analysis. <em>Genomics, 2</em>(3), 231–239.
      https://doi.org/10.1016/0888-7543(88)90007-9
    </li>
  </ul>

  <!-- METAGENOMIC COVERAGE, ABUNDANCE, GENOME SIZE -->
  <h3>Metagenomic Coverage, Genome Size, and Abundance Relationships</h3>
  <ul>
    <li>
      Nayfach, S., & Pollard, K. S. (2016). Average genome size estimation improves comparative
      metagenomics and sheds light on the functional ecology of the human microbiome.
      <em>Genome Biology, 16</em>, 51.
      https://pmc.ncbi.nlm.nih.gov/articles/PMC4389708/
    </li>
    <li>
      Nayfach, S., & Pollard, K. S. (2016). Toward accurate and quantitative comparative metagenomics.
      <em>Cell, 166</em>(5), 1103–1116.
      https://doi.org/10.1016/j.cell.2016.08.007
    </li>
  </ul>

  <!-- HUMAN GUT MICROBIOME & LARGE-SCALE CATALOGS -->
  <h3>Human Gut Microbiome & Large‑Scale Metagenomic Catalogs</h3>
  <ul>
    <li>
      Qin, J., Li, R., Raes, J., et al. (2010). A human gut microbial gene catalogue established by
      metagenomic sequencing. <em>Nature, 464</em>(7285), 59–65.
      https://doi.org/10.1038/nature08821
    </li>
    <li>
      Huttenhower, C., Gevers, D., Knight, R., et al. (2012). Structure, function and diversity of the
      healthy human microbiome. <em>Nature, 486</em>(7402), 207–214.
      https://doi.org/10.1038/nature11234
    </li>
    <li>
      Almeida, A., Nayfach, S., Boland, M., et al. (2021). A unified catalog of 204,938 reference genomes
      from the human gut microbiome. <em>Nature Biotechnology, 39</em>(1), 105–114.
      https://doi.org/10.1038/s41587-020-0603-3
    </li>
    <li>
      Almeida, A., Mitchell, A. L., Boland, M., et al. (2019). A new genomic blueprint of the human gut
      microbiota. <em>Nature, 568</em>(7753), 499–504.
      https://doi.org/10.1038/s41586-019-0965-1
    </li>
  </ul>

  <!-- MAG RECOVERY & ASSEMBLY -->
  <h3>MAG Recovery, Assembly, and Coverage Requirements</h3>
  <ul>
    <li>
      Parks, D. H., Rinke, C., Chuvochina, M., et al. (2017). Recovery of nearly 8,000 metagenome‑assembled
      genomes substantially expands the tree of life. <em>Nature Microbiology, 2</em>, 1533–1542.
      https://doi.org/10.1038/s41564-017-0012-7
    </li>
    <li>
      Nielsen, H. B., Almeida, M., Juncker, A. S., et al. (2014). Identification and assembly of genomes
      and genetic elements in complex metagenomic samples without using reference genomes.
      <em>Nature Biotechnology, 32</em>(8), 822–828.
      https://doi.org/10.1038/nbt.2939
    </li>
    <li>
      Stewart, R. D., Auffret, M. D., Warr, A., et al. (2018). Assembly of 913 microbial genomes from
      metagenomic sequencing of the cow rumen. <em>Nature Communications, 9</em>(1), 870.
      https://doi.org/10.1038/s41467-018-03317-6
    </li>
    <li>
      Seshadri, R., Leahy, S. C., Attwood, G. T., et al. (2018). Cultivation and sequencing of rumen
      microbiome members from the Hungate1000 Collection. <em>Nature Biotechnology, 36</em>(4), 359–367.
      https://doi.org/10.1038/nbt.4110
    </li>
  </ul>

  <!-- SHALLOW SHOTGUN & DEPTH BENCHMARKING -->
  <h3>Shallow Shotgun Sequencing, Depth Benchmarking, and Protocol Evaluation</h3>
  <ul>
    <li>
      Treichel, N. S., Pauvert, C., Séneca, J., et al. (2026). Benchmarking of shotgun sequencing depth
      highlights limitations of strain‑level analysis and shallow metagenomics.
      <em>bioRxiv</em>. https://doi.org/10.1101/2025.03.27.645659
    </li>
    <li>
      Yu, K. H. O., Fang, X., Yao, H., et al. (2022). Evaluation of experimental protocols for shotgun
      whole‑genome metagenomic discovery of antibiotic resistance genes.
      <em>IEEE/ACM Transactions on Computational Biology and Bioinformatics, 19</em>(3), 1313–1321.
      https://doi.org/10.1109/TCBB.2020.3004063
    </li>
    <li>
      Tremblay, J., Schreiber, L., & Greer, C. W. (2022). High‑resolution shotgun metagenomics:
      The more data, the better? <em>Briefings in Bioinformatics, 23</em>(6), bbac443.
      https://doi.org/10.1093/bib/bbac443
    </li>
    <li>
      Gaulke, C. A., Schmeltzer, E. R., Dasenko, M., et al. (2021). Evaluation of the effects of library
      preparation procedure and sample characteristics on the accuracy of metagenomic profiles.
      <em>mSystems, 6</em>(5). https://doi.org/10.1128/msystems.00440-21
    </li>
    <li>
      Xu, W., Chen, T., Pei, Y., et al. (2021). Characterization of shallow whole‑metagenome shotgun
      sequencing as a high‑accuracy and low‑cost method by complicated mock microbiomes.
      <em>Frontiers in Microbiology, 12</em>, 678319.
      https://doi.org/10.3389/fmicb.2021.678319
    </li>
    <li>
      Hillmann, B., Al‑Ghalith, G. A., Shields‑Cutler, R. R., et al. (2018). Evaluating the information
      content of shallow shotgun metagenomics. <em>mSystems, 3</em>(6).
      https://doi.org/10.1128/msystems.00069-18
    </li>
    <li>
      Cheng, W. Y., Liu, W. X., Ding, Y., et al. (2023). High sensitivity of shotgun metagenomic sequencing
      in colon tissue biopsy by host DNA depletion. <em>Genomics, Proteomics & Bioinformatics, 21</em>(6),
      1195–1205. https://doi.org/10.1016/j.gpb.2022.09
    </li>
  </ul>

  <p>
    These papers collectively support the mathematical definitions of coverage, the relationship
    between sequencing depth and relative abundance, and the empirical coverage thresholds used
    for MAG recovery, pathway inference, and taxonomic profiling.
  </p>
</div>


</body>
</html>
